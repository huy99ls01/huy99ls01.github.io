---
title: "Recurrent Neural Networks"
subtitle: "Mạng Recurrent Neural Networks hoạt động như nào?"
layout: post
tags: [Recurrent Neural Networks, RNN]
---

## Sequence Data 

 RNN là mạng neural networks rất tốt trong việc mô hình hóa dữ liệu. Để hiểu được nó trước tiên hãy làm 1 thí nghiệm. Giả sử bạn có ảnh(still snapshot) của một quả bóng đang di chuyển. 
 
 <center>
  <img src="/img/bp/2018-06-18-RNN/ball.png" alt="None">
 </center>
 
 Giả sử như chúng ta muốn dự đoán hướng đi của quả bóng. Vậy chỉ với thông tin được cho bên trên, làm sao có thể dự đoán được? well,có thể đoán hướng đi của quả bóng, nhưng đó sẽ là câu câu trả lời ngẫu nhiên :)). Khi chúng không có thông tin quả bóng đã từng ở đâu, thì sẽ không có đủ dữ liệu để dự đoán được hướng đi của quả bóng.
 
 Nếu chụp liên tiếp vị trí của quả bóng. Chúng ta sẽ sẽ có đủ thông tin để dự đoán hướng đi của quả bóng.

 <center>
  <img src="/img/bp/2018-06-18-RNN/ball.gif" alt="None">
 </center>

Vậy đây là một chuỗi theo một thứ tự cụ thể trong đó một vật theo sau bởi vật khác. Với thông tin này giờ chúng ta đã có thể dự đoán được quả bóng đang di chuyển sang bên phải

Sequence data(dữ liệu trình tự) có nhiều dạng khác nhau. Audio(âm thanh) là 1 dạng sequence tự nhiên. Chúng ta có thể cắt các phổ âm thanh thành 1 khối và đưa vào mạng RNN.

 <center>
  <img src="/img/bp/2018-06-18-RNN/audio.png" alt="None">
  <br>
  <em>Phổ âm thanh được cắt ra thành nhiều khối</em>
 </center>

văn bản cũng là 1 dạng khác của chuỗi(sequence). Được chia nhỏ thành chuỗi các chữ cái hoặc chuỗi các từ(word).

## Sequential Memory

Ok, vậy thì RNN rất tốt trong việc xử lý chuỗi để dự đoán. But How?

Well, họ làm điều đó bằng cách có 1 khái niệm được gọi là Sequential Memory(bộ nhớ trình tự). Để hiểu được Sequential Memory, hãy nhớ lại bảng chữ cái và đọc lại nó.

 <center>
  <img src="/img/bp/2018-06-18-RNN/abc.png" alt="None">
 </center>
 
 Khá là dễ đúng không :)). Bởi vì chúng ta đã được dạy đọc trình tự bảng chữ cái này từ nhỏ, nên chúng ta sẽ nhanh chóng đọc được nó.
 
 Bây giờ thử đọc bảng chữ cái theo chiều ngược lại.
 

 <center>
  <img src="/img/bp/2018-06-18-RNN/abcre.png" alt="None">
 </center>
 
 chắc chắn là khó hơn :)), Trừ khi bạn được tập luyện để đọc ngược bảng chữ cái không thì sẽ rất khó khăn để đọc nó.
 
 Hoặc là bạn có thể đọc từ chữ cái F.
 
 <center>
  <img src="/img/bp/2018-06-18-RNN/fabc.png" alt="None">
 </center>
 
 Lúc đầu bạn sẽ vật lộn với vài chữ cái đầu tiên, nhưng sau khi não của bạn nhớ ra trình tự của bảng chữ cái thì phần còn lại sẽ rất dễ đọc. 
 
Khi học bảng chữ cái chúng ta thường học theo chuỗi trình tự. Sequential Memory giúp não của chúng ta dễ dàng hơn trong việc nhận dạng các mô hình theo chuỗi trình tự.

## Recurrent Neural Network

Alright, vậy thì mạng RNN có khái niệm trừu tượng về Sequential Memory(bộ nhớ trình tự), nhưng làm thế nào mạng RNN có thể tái tạo lại nó từ khái niệm đó. Well, hãy nhìn xuống hình bên dưới là mạng neural network truyền thống và cũng được biết đến là feed-forward neural network. Mạng Neural Network có input layer, hidden layer và output layer.

 <center>
  <img src="/img/bp/2018-06-18-RNN/FFW.png" alt="None">
 <em>Feed Forward Neural Network</em>
 </center>

Làm sao để có một mạng feed-forward neural network mà có thể dùng thông tin trước đó để ảnh hưởng tới thông tin đằng sau?. Nếu chúng ta thêm vào một vòng lặp trong neural network mà có thể đưa thông tin trước đó lên phía trước?

<center>
  <img src="/img/bp/2018-06-18-RNN/RNN.png" alt="None">
 <br>
 <em>Recurrent Neural Network</em>
 </center>

Về cơ bản đó là những gì mà mạng recurrent neural network làm. Mạng RNN có một cơ chế vồng lặp đóng vai trò như một đường cao tốc cho phép thông tin đi từ bước này đến bước tiếp theo.

<center>
  <img src="/img/bp/2018-06-18-RNN/hidden.gif" alt="None">
 <br>
 <em>Passing Hidden State to next time step</em>
 </center>

Thông tin này là hidden state, là đại diện cho các input trước đó. Hãy cùng xem qua một ứng dụng sử dụng mạng RNN để hiểu rõ hơn về cách nó hoạt động.

Giả sử chúng ta muốn xây dựng một con chatbot, và con chatbot này có thể phân loại được mục đích của người dùng từ văn bản người dùng nhập vào.

<center>
  <img src="/img/bp/2018-06-18-RNN/classify.gif" alt="None">
 <br>
 <em>Classifying intents from users inputs</em>
 </center>
 
 Để giải quyết vấn đề này. Đầu tiên chúng ta sẽ sử dụng mạng RNN để encode sequence of text(chuỗi văn bản). Sau đó chúng ta sẽ đưa output của mạng RNN vào mạng feed-forward neural network và nó sẽ phân loại mục đích của người viết.
 
 Khi mà user gõ từ bàn phím What time is it? Đầu tiên chúng ta sẽ chia chuỗi văn bản thành các từ riêng biệt. Vì mạng RNN làm việc theo trình tự nên chúng ta sẽ đưa vào từng từ một.
 
 
 <center>
  <img src="/img/bp/2018-06-18-RNN/breakingsen.gif" alt="None">
 <br>
 <em>Breaking up a sentence into word sequences</em>
 </center>
 
 Bước đầu tiên sẽ đưa từ "What" vào mạng RNN. RNN sẽ encode từ "what" và đưa ra kết quả là output.
 
 <center>
  <img src="/img/bp/2018-06-18-RNN/breakingsen2.gif" alt="None">
 </center>
 
 Tiếp theo đó là từ "time" sẽ được đưa vào cùng với nó là hidden state từ bước trước. Và hiện giờ RNN sẽ có thông tin của 2 từ là "What" và "time".
 
 <center>
  <img src="/img/bp/2018-06-18-RNN/breakingsen3.gif" alt="None">
 </center>
 
 Chúng ta tiếp tục lặp lại các bước như vậy cho đến khi encode hết tất các thông tin của các từ trong chuỗi từ các bước trước đó.
 
  <center>
  <img src="/img/bp/2018-06-18-RNN/breakingsen4.gif" alt="None">
 </center>
 
 Khi mà final output được tạo bởi tất cả các từ trong một chuỗi. Và giờ chúng ta có thể lấy final output để đưa vào feed-forward layer và phân loại mục đích của chuỗi văn bản đó.
 
  <center>
  <img src="/img/bp/2018-06-18-RNN/breakingsen5.gif" alt="None">
 </center>
 
## Vanishing Gradient
 
 sdds








