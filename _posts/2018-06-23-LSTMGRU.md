---
title: "LSTM và GRU"
subtitle: "LSTM và GRU hoạt động như nào?"
layout: post
tags: [LSTM, GRU, Long Short Term Memory, Gated Recurrent Unit]
---

## The Problem, Short-term Memory

Như chúng ta đã biết từ phần một, RNN gặp phải một vấn đề trong việc xử lý một chuỗi dữ liệu dài, đó là short-term memory.
Và sẽ gặp khó khăn trong việc vận chuyển thông tin từ những bước đầu tiên cho đến bước cuối trong quá trình xử lý dữ liệu, 
nếu chúng ta muốn dự đoán một đoạn văn bản thì rnn có lẽ sẽ bỏ rơi những thông tin quan trọng ngay từ đầu văn bản.
Trong quá trình rnn thực hiện back-propagation sẽ gặp phải vanishing gradient. Trong đó gradient là giá trị dùng để điều chỉnh trọng số(weight) trong mạng neural networks. Vanishing gradient xảy ra khi giá trị gradient trở nên rất nhỏ sau mỗi bước back-prop và nếu giá trị của gradient rất nhỏ thì trọng số của mạng neural sẽ gần như không thay đổi và điều đó có nghĩa là mạng neural sẽ không thể học(learn) và tối ưu được.

 <center>
  <img src="/img/bp/2018-06-23-LSTMGRU/gradientupdate.png" alt="None">
  <br>
  <i>Gradient Update Rule</i>
 </center>
 
 Thường thì những layer đầu tiên trong mạng recurrent sẽ không được điều chỉnh hay học được do gradient rất nhỏ. Và vì những layer đầu tiên không học được nên dẫn đến việc rnn có thể sẽ bỏ quên những thông tin ban đầu khi mà phải xử lý chuỗi dữ liệu dài. 

## LSTM’s and GRU’s as a solution

LSTM và GRU được tạo ra để giải quyết vấn đề về short-term memory. Và đều dùng chung một cơ chế được gọi là cổng(gate) để điều chỉnh luồng thông tin.

 <center>
  <img src="/img/bp/2018-06-23-LSTMGRU/lstmgrucompare.png" alt="None">
 </center>
 
 Các cổng này được học từ dữ liệu và từ đó quyết định xem thông tin quan trọng nào trong chuỗi dữ liệu được giữ lại hoặc bỏ đi. Bằng cách làm như vậy nó có thể đưa những thông tin liên quan trong chuỗi dữ liệu đến bước cuối của quá trình xử lý chuỗi dữ liệu và thực hiện dự đoán. Hầu hết những bài toán sử dụng mạng recurrent đạt được kết quả rất tốt đều dùng LSTM hoặc GRU. LSTM và GRU còn được dùng trong nhận dạng giọng nói(speech recognition), tổng hợp giọng nói(speech synthesis) và sinh văn bản(text generation), và còn có thể dùng để sinh ra các chú thích(generate captions) cho video.

## Intuition

Ok, đầu tiên thử làm một thí nghiệm trước nhé. Giả sử như bờ dô đang đọc review của khách hàng về sản phẩm để quyết định xem có nên mua sản phẩm đó hay không. Điều đầu tiên bờ dô làm là đọc review để xem có tay nào cho biết quan điểm của hắn về sản phẩm này có ok hay không.

 <center>
  <img src="/img/bp/2018-06-23-LSTMGRU/review.png" alt="None">
 </center>














